# è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ - ä¸€é”®åˆ›å»ºLogic Apps

## ğŸ¯ æ¦‚è¿°

ä½¿ç”¨Azure CLI + ARMæ¨¡æ¿è‡ªåŠ¨åˆ›å»ºæ‰€æœ‰èµ„æºï¼Œä¸éœ€è¦æ‰‹åŠ¨ç‚¹å‡»ï¼

---

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### 1. å®‰è£…Azure CLI

**Windows**:
```powershell
# ä¸‹è½½å®‰è£…å™¨
# https://aka.ms/installazurecliwindows
# æˆ–ä½¿ç”¨ winget
winget install -e --id Microsoft.AzureCLI
```

**éªŒè¯å®‰è£…**:
```bash
az --version
```

### 2. ç™»å½•Azure
```bash
az login
```

ä¼šæ‰“å¼€æµè§ˆå™¨ï¼Œç™»å½•ä½ çš„Azureè´¦å·ã€‚

---

## ğŸš€ æ–¹æ¡ˆAï¼šå¿«é€Ÿéƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰

### åˆ›å»ºéƒ¨ç½²è„šæœ¬

åˆ›å»ºæ–‡ä»¶ `deploy.ps1`ï¼ˆWindows PowerShellï¼‰æˆ– `deploy.sh`ï¼ˆMac/Linuxï¼‰ï¼š

**deploy.ps1** (Windows):
```powershell
# ========================================
# Azure äº‘åŸç”Ÿå¤šåª’ä½“å¹³å°è‡ªåŠ¨éƒ¨ç½²è„šæœ¬
# ========================================

# é…ç½®å˜é‡
$RESOURCE_GROUP = "multimedia-platform-rg"
$LOCATION = "eastus"
$STORAGE_ACCOUNT = "multimedia" + (Get-Random -Minimum 1000 -Maximum 9999)
$COSMOSDB_ACCOUNT = "multimedia-cosmosdb-" + (Get-Random -Minimum 1000 -Maximum 9999)
$CONTAINER_NAME = "media-files"
$DATABASE_NAME = "MediaDB"
$COLLECTION_NAME = "MediaItems"

Write-Host "========================================" -ForegroundColor Cyan
Write-Host "å¼€å§‹éƒ¨ç½²äº‘åŸç”Ÿå¤šåª’ä½“å¹³å°" -ForegroundColor Cyan
Write-Host "========================================" -ForegroundColor Cyan

# 1. åˆ›å»ºèµ„æºç»„
Write-Host "`n[1/6] åˆ›å»ºèµ„æºç»„..." -ForegroundColor Yellow
az group create `
  --name $RESOURCE_GROUP `
  --location $LOCATION

# 2. åˆ›å»ºå­˜å‚¨è´¦æˆ·
Write-Host "`n[2/6] åˆ›å»ºå­˜å‚¨è´¦æˆ·..." -ForegroundColor Yellow
az storage account create `
  --name $STORAGE_ACCOUNT `
  --resource-group $RESOURCE_GROUP `
  --location $LOCATION `
  --sku Standard_LRS `
  --kind StorageV2

# è·å–å­˜å‚¨è´¦æˆ·è¿æ¥å­—ç¬¦ä¸²
$STORAGE_CONNECTION = az storage account show-connection-string `
  --name $STORAGE_ACCOUNT `
  --resource-group $RESOURCE_GROUP `
  --query connectionString `
  --output tsv

Write-Host "å­˜å‚¨è´¦æˆ·è¿æ¥å­—ç¬¦ä¸²å·²è·å–" -ForegroundColor Green

# 3. åˆ›å»ºBlobå®¹å™¨
Write-Host "`n[3/6] åˆ›å»ºBlobå®¹å™¨..." -ForegroundColor Yellow
az storage container create `
  --name $CONTAINER_NAME `
  --account-name $STORAGE_ACCOUNT `
  --public-access blob

# 4. åˆ›å»ºCosmos DBè´¦æˆ·
Write-Host "`n[4/6] åˆ›å»ºCosmos DBè´¦æˆ·ï¼ˆè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿï¼‰..." -ForegroundColor Yellow
az cosmosdb create `
  --name $COSMOSDB_ACCOUNT `
  --resource-group $RESOURCE_GROUP `
  --locations regionName=$LOCATION `
  --capabilities EnableServerless `
  --default-consistency-level Session

# è·å–Cosmos DBè¿æ¥ä¿¡æ¯
$COSMOS_ENDPOINT = az cosmosdb show `
  --name $COSMOSDB_ACCOUNT `
  --resource-group $RESOURCE_GROUP `
  --query documentEndpoint `
  --output tsv

$COSMOS_KEY = az cosmosdb keys list `
  --name $COSMOSDB_ACCOUNT `
  --resource-group $RESOURCE_GROUP `
  --query primaryMasterKey `
  --output tsv

Write-Host "Cosmos DBå·²åˆ›å»º" -ForegroundColor Green

# 5. åˆ›å»ºCosmos DBæ•°æ®åº“å’Œå®¹å™¨
Write-Host "`n[5/6] åˆ›å»ºCosmos DBæ•°æ®åº“å’Œå®¹å™¨..." -ForegroundColor Yellow
az cosmosdb sql database create `
  --account-name $COSMOSDB_ACCOUNT `
  --resource-group $RESOURCE_GROUP `
  --name $DATABASE_NAME

az cosmosdb sql container create `
  --account-name $COSMOSDB_ACCOUNT `
  --database-name $DATABASE_NAME `
  --resource-group $RESOURCE_GROUP `
  --name $COLLECTION_NAME `
  --partition-key-path "/userId"

# 6. ä¿å­˜é…ç½®ä¿¡æ¯
Write-Host "`n[6/6] ä¿å­˜é…ç½®ä¿¡æ¯..." -ForegroundColor Yellow

$CONFIG = @"
========================================
éƒ¨ç½²å®Œæˆï¼è¯·ä¿å­˜ä»¥ä¸‹ä¿¡æ¯
========================================

èµ„æºç»„: $RESOURCE_GROUP
åŒºåŸŸ: $LOCATION

å­˜å‚¨è´¦æˆ·å: $STORAGE_ACCOUNT
Blobå®¹å™¨å: $CONTAINER_NAME
å­˜å‚¨è¿æ¥å­—ç¬¦ä¸²:
$STORAGE_CONNECTION

Cosmos DBè´¦æˆ·å: $COSMOSDB_ACCOUNT
Cosmos DBç»ˆç»“ç‚¹: $COSMOS_ENDPOINT
Cosmos DBä¸»å¯†é’¥: $COSMOS_KEY
æ•°æ®åº“å: $DATABASE_NAME
å®¹å™¨å: $COLLECTION_NAME

========================================
ä¸‹ä¸€æ­¥ï¼šåˆ›å»ºLogic Apps
è¯·è¿è¡Œ: .\deploy-logicapps.ps1
========================================
"@

Write-Host $CONFIG -ForegroundColor Green

# ä¿å­˜åˆ°æ–‡ä»¶
$CONFIG | Out-File -FilePath "deployment-config.txt" -Encoding UTF8

Write-Host "`né…ç½®å·²ä¿å­˜åˆ° deployment-config.txt" -ForegroundColor Cyan
```

---

### è¿è¡Œéƒ¨ç½²è„šæœ¬

```powershell
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell
.\deploy.ps1
```

ç­‰å¾…5-10åˆ†é’Ÿï¼Œæ‰€æœ‰åŸºç¡€èµ„æºå°±åˆ›å»ºå¥½äº†ï¼

---

## ğŸ”§ æ–¹æ¡ˆBï¼šä½¿ç”¨ARMæ¨¡æ¿éƒ¨ç½²Logic Apps

### åˆ›å»ºLogic App ARMæ¨¡æ¿

åˆ›å»ºæ–‡ä»¶ `logic-app-upload.json`:

```json
{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "logicAppName": {
      "type": "string",
      "defaultValue": "upload-media-logic",
      "metadata": {
        "description": "Logic Appåç§°"
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[resourceGroup().location]",
      "metadata": {
        "description": "éƒ¨ç½²åŒºåŸŸ"
      }
    },
    "storageAccountName": {
      "type": "string",
      "metadata": {
        "description": "å­˜å‚¨è´¦æˆ·å"
      }
    },
    "cosmosDbAccountName": {
      "type": "string",
      "metadata": {
        "description": "Cosmos DBè´¦æˆ·å"
      }
    }
  },
  "variables": {
    "blobConnectionName": "azureblob",
    "cosmosDbConnectionName": "cosmosdb"
  },
  "resources": [
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2016-06-01",
      "name": "[variables('blobConnectionName')]",
      "location": "[parameters('location')]",
      "properties": {
        "displayName": "BlobConnection",
        "api": {
          "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/azureblob')]"
        },
        "parameterValues": {
          "accountName": "[parameters('storageAccountName')]",
          "accessKey": "[listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2021-09-01').keys[0].value]"
        }
      }
    },
    {
      "type": "Microsoft.Web/connections",
      "apiVersion": "2016-06-01",
      "name": "[variables('cosmosDbConnectionName')]",
      "location": "[parameters('location')]",
      "properties": {
        "displayName": "CosmosDBConnection",
        "api": {
          "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/documentdb')]"
        },
        "parameterValues": {
          "databaseAccount": "[parameters('cosmosDbAccountName')]",
          "accessKey": "[listKeys(resourceId('Microsoft.DocumentDB/databaseAccounts', parameters('cosmosDbAccountName')), '2021-10-15').primaryMasterKey]"
        }
      }
    },
    {
      "type": "Microsoft.Logic/workflows",
      "apiVersion": "2019-05-01",
      "name": "[parameters('logicAppName')]",
      "location": "[parameters('location')]",
      "dependsOn": [
        "[resourceId('Microsoft.Web/connections', variables('blobConnectionName'))]",
        "[resourceId('Microsoft.Web/connections', variables('cosmosDbConnectionName'))]"
      ],
      "properties": {
        "state": "Enabled",
        "definition": {
          "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
          "contentVersion": "1.0.0.0",
          "parameters": {
            "$connections": {
              "defaultValue": {},
              "type": "Object"
            }
          },
          "triggers": {
            "manual": {
              "type": "Request",
              "kind": "Http",
              "inputs": {
                "method": "POST",
                "schema": {
                  "type": "object",
                  "properties": {
                    "fileName": {
                      "type": "string"
                    },
                    "fileType": {
                      "type": "string"
                    },
                    "userId": {
                      "type": "string"
                    },
                    "tags": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    },
                    "fileContent": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "actions": {
            "Initialize_fileId": {
              "runAfter": {},
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "fileId",
                    "type": "string",
                    "value": "@{guid()}"
                  }
                ]
              }
            },
            "Initialize_blobName": {
              "runAfter": {
                "Initialize_fileId": [
                  "Succeeded"
                ]
              },
              "type": "InitializeVariable",
              "inputs": {
                "variables": [
                  {
                    "name": "blobName",
                    "type": "string",
                    "value": "@{concat(variables('fileId'), '-', triggerBody()?['fileName'])}"
                  }
                ]
              }
            },
            "Create_blob": {
              "runAfter": {
                "Initialize_blobName": [
                  "Succeeded"
                ]
              },
              "type": "ApiConnection",
              "inputs": {
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['azureblob']['connectionId']"
                  }
                },
                "method": "post",
                "path": "/v2/datasets/@{encodeURIComponent(encodeURIComponent('AccountNameFromSettings'))}/files",
                "queries": {
                  "folderPath": "/media-files",
                  "name": "@{variables('blobName')}",
                  "queryParametersSingleEncoded": true
                },
                "body": "@base64ToBinary(triggerBody()?['fileContent'])",
                "headers": {
                  "Content-Type": "@{triggerBody()?['fileType']}"
                }
              }
            },
            "Create_or_update_document": {
              "runAfter": {
                "Create_blob": [
                  "Succeeded"
                ]
              },
              "type": "ApiConnection",
              "inputs": {
                "host": {
                  "connection": {
                    "name": "@parameters('$connections')['documentdb']['connectionId']"
                  }
                },
                "method": "post",
                "path": "/v2/cosmosdb/@{encodeURIComponent('MediaDB')}/collections/@{encodeURIComponent('MediaItems')}/documents",
                "body": {
                  "id": "@{variables('fileId')}",
                  "userId": "@{triggerBody()?['userId']}",
                  "fileName": "@{triggerBody()?['fileName']}",
                  "blobName": "@{variables('blobName')}",
                  "fileUrl": "@{concat('https://', parameters('storageAccountName'), '.blob.core.windows.net/media-files/', variables('blobName'))}",
                  "fileType": "@{triggerBody()?['fileType']}",
                  "tags": "@triggerBody()?['tags']",
                  "uploadDate": "@{utcNow()}",
                  "isDeleted": false
                },
                "headers": {
                  "x-ms-documentdb-partition-key": "@{triggerBody()?['userId']}"
                }
              }
            },
            "Response": {
              "runAfter": {
                "Create_or_update_document": [
                  "Succeeded"
                ]
              },
              "type": "Response",
              "inputs": {
                "statusCode": 200,
                "body": {
                  "success": true,
                  "message": "File uploaded successfully",
                  "data": {
                    "id": "@{variables('fileId')}",
                    "fileName": "@{triggerBody()?['fileName']}",
                    "fileUrl": "@{concat('https://', parameters('storageAccountName'), '.blob.core.windows.net/media-files/', variables('blobName'))}",
                    "uploadDate": "@{utcNow()}"
                  }
                }
              }
            }
          }
        },
        "parameters": {
          "$connections": {
            "value": {
              "azureblob": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('blobConnectionName'))]",
                "connectionName": "azureblob",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/azureblob')]"
              },
              "documentdb": {
                "connectionId": "[resourceId('Microsoft.Web/connections', variables('cosmosDbConnectionName'))]",
                "connectionName": "documentdb",
                "id": "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', parameters('location'), '/managedApis/documentdb')]"
              }
            }
          }
        }
      }
    }
  ],
  "outputs": {
    "logicAppUrl": {
      "type": "string",
      "value": "[listCallbackURL(concat(resourceId('Microsoft.Logic/workflows', parameters('logicAppName')), '/triggers/manual'), '2019-05-01').value]"
    }
  }
}
```

### éƒ¨ç½²ARMæ¨¡æ¿

```powershell
# éƒ¨ç½²Logic App
az deployment group create `
  --resource-group multimedia-platform-rg `
  --template-file logic-app-upload.json `
  --parameters `
    storageAccountName=multimedia1234 `
    cosmosDbAccountName=multimedia-cosmosdb-1234
```

---

## ğŸ æ–¹æ¡ˆCï¼šä¸€é”®éƒ¨ç½²å®Œæ•´è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

åˆ›å»ºæ–‡ä»¶ `quick-deploy.ps1`:

```powershell
# ========================================
# ä¸€é”®éƒ¨ç½²å®Œæ•´äº‘åŸç”Ÿå¤šåª’ä½“å¹³å°
# ========================================

param(
    [string]$ResourceGroup = "multimedia-platform-rg",
    [string]$Location = "eastus"
)

# ç”Ÿæˆå”¯ä¸€æ ‡è¯†ç¬¦
$suffix = Get-Random -Minimum 1000 -Maximum 9999
$storageAccount = "multimedia$suffix"
$cosmosAccount = "multimedia-cosmos-$suffix"

Write-Host "========================================" -ForegroundColor Cyan
Write-Host "äº‘åŸç”Ÿå¤šåª’ä½“å¹³å° - ä¸€é”®éƒ¨ç½²" -ForegroundColor Cyan
Write-Host "========================================" -ForegroundColor Cyan
Write-Host ""
Write-Host "èµ„æºç»„: $ResourceGroup" -ForegroundColor White
Write-Host "åŒºåŸŸ: $Location" -ForegroundColor White
Write-Host "å­˜å‚¨è´¦æˆ·: $storageAccount" -ForegroundColor White
Write-Host "Cosmos DB: $cosmosAccount" -ForegroundColor White
Write-Host ""

# ç¡®è®¤ç»§ç»­
$confirm = Read-Host "æ˜¯å¦ç»§ç»­éƒ¨ç½²ï¼Ÿ(Y/N)"
if ($confirm -ne "Y" -and $confirm -ne "y") {
    Write-Host "éƒ¨ç½²å·²å–æ¶ˆ" -ForegroundColor Yellow
    exit
}

# è®¾ç½®é»˜è®¤è®¢é˜…ï¼ˆå¦‚æœæœ‰å¤šä¸ªï¼‰
Write-Host "`næ£€æŸ¥Azureè®¢é˜…..." -ForegroundColor Yellow
$subscriptions = az account list --query "[].{name:name, id:id}" -o json | ConvertFrom-Json
if ($subscriptions.Count -gt 1) {
    Write-Host "æ‰¾åˆ°å¤šä¸ªè®¢é˜…ï¼š" -ForegroundColor Yellow
    for ($i = 0; $i -lt $subscriptions.Count; $i++) {
        Write-Host "[$i] $($subscriptions[$i].name)" -ForegroundColor White
    }
    $choice = Read-Host "è¯·é€‰æ‹©è®¢é˜…ç¼–å· (0-$($subscriptions.Count-1))"
    az account set --subscription $subscriptions[$choice].id
}

# 1. åˆ›å»ºèµ„æºç»„
Write-Host "`n[æ­¥éª¤ 1/8] åˆ›å»ºèµ„æºç»„..." -ForegroundColor Cyan
az group create --name $ResourceGroup --location $Location --output none
Write-Host "âœ“ èµ„æºç»„åˆ›å»ºæˆåŠŸ" -ForegroundColor Green

# 2. åˆ›å»ºå­˜å‚¨è´¦æˆ·
Write-Host "`n[æ­¥éª¤ 2/8] åˆ›å»ºå­˜å‚¨è´¦æˆ·..." -ForegroundColor Cyan
az storage account create `
  --name $storageAccount `
  --resource-group $ResourceGroup `
  --location $Location `
  --sku Standard_LRS `
  --kind StorageV2 `
  --output none
Write-Host "âœ“ å­˜å‚¨è´¦æˆ·åˆ›å»ºæˆåŠŸ" -ForegroundColor Green

# 3. åˆ›å»ºBlobå®¹å™¨
Write-Host "`n[æ­¥éª¤ 3/8] åˆ›å»ºBlobå®¹å™¨..." -ForegroundColor Cyan
az storage container create `
  --name media-files `
  --account-name $storageAccount `
  --public-access blob `
  --output none
Write-Host "âœ“ Blobå®¹å™¨åˆ›å»ºæˆåŠŸ" -ForegroundColor Green

# 4. åˆ›å»ºCosmos DB
Write-Host "`n[æ­¥éª¤ 4/8] åˆ›å»ºCosmos DB (è¿™éœ€è¦3-5åˆ†é’Ÿ)..." -ForegroundColor Cyan
az cosmosdb create `
  --name $cosmosAccount `
  --resource-group $ResourceGroup `
  --locations regionName=$Location `
  --capabilities EnableServerless `
  --default-consistency-level Session `
  --output none
Write-Host "âœ“ Cosmos DBåˆ›å»ºæˆåŠŸ" -ForegroundColor Green

# 5. åˆ›å»ºæ•°æ®åº“
Write-Host "`n[æ­¥éª¤ 5/8] åˆ›å»ºCosmos DBæ•°æ®åº“..." -ForegroundColor Cyan
az cosmosdb sql database create `
  --account-name $cosmosAccount `
  --resource-group $ResourceGroup `
  --name MediaDB `
  --output none
Write-Host "âœ“ æ•°æ®åº“åˆ›å»ºæˆåŠŸ" -ForegroundColor Green

# 6. åˆ›å»ºå®¹å™¨
Write-Host "`n[æ­¥éª¤ 6/8] åˆ›å»ºCosmos DBå®¹å™¨..." -ForegroundColor Cyan
az cosmosdb sql container create `
  --account-name $cosmosAccount `
  --database-name MediaDB `
  --resource-group $ResourceGroup `
  --name MediaItems `
  --partition-key-path "/userId" `
  --output none
Write-Host "âœ“ å®¹å™¨åˆ›å»ºæˆåŠŸ" -ForegroundColor Green

# 7. è·å–è¿æ¥ä¿¡æ¯
Write-Host "`n[æ­¥éª¤ 7/8] è·å–è¿æ¥ä¿¡æ¯..." -ForegroundColor Cyan

$storageKey = az storage account keys list `
  --account-name $storageAccount `
  --resource-group $ResourceGroup `
  --query "[0].value" `
  --output tsv

$storageConnection = "DefaultEndpointsProtocol=https;AccountName=$storageAccount;AccountKey=$storageKey;EndpointSuffix=core.windows.net"

$cosmosEndpoint = az cosmosdb show `
  --name $cosmosAccount `
  --resource-group $ResourceGroup `
  --query documentEndpoint `
  --output tsv

$cosmosKey = az cosmosdb keys list `
  --name $cosmosAccount `
  --resource-group $ResourceGroup `
  --query primaryMasterKey `
  --output tsv

Write-Host "âœ“ è¿æ¥ä¿¡æ¯è·å–æˆåŠŸ" -ForegroundColor Green

# 8. ä¿å­˜é…ç½®
Write-Host "`n[æ­¥éª¤ 8/8] ä¿å­˜é…ç½®ä¿¡æ¯..." -ForegroundColor Cyan

$config = @{
    resourceGroup = $ResourceGroup
    location = $Location
    storage = @{
        accountName = $storageAccount
        containerName = "media-files"
        connectionString = $storageConnection
        accountKey = $storageKey
    }
    cosmosDb = @{
        accountName = $cosmosAccount
        endpoint = $cosmosEndpoint
        primaryKey = $cosmosKey
        databaseName = "MediaDB"
        containerName = "MediaItems"
    }
}

# ä¿å­˜ä¸ºJSON
$config | ConvertTo-Json -Depth 3 | Out-File -FilePath "config.json" -Encoding UTF8

# ç”Ÿæˆå‰ç«¯é…ç½®æ–‡ä»¶
$frontendConfig = @"
// Azureé…ç½® - è‡ªåŠ¨ç”Ÿæˆ
const AZURE_CONFIG = {
    storage: {
        accountName: '$storageAccount',
        containerName: 'media-files',
        blobUrl: 'https://$storageAccount.blob.core.windows.net/media-files/'
    },
    cosmosDb: {
        accountName: '$cosmosAccount',
        databaseName: 'MediaDB',
        containerName: 'MediaItems'
    },
    // Logic Apps URLs - éœ€è¦åˆ›å»ºåæ‰‹åŠ¨æ›´æ–°
    logicApps: {
        upload: 'YOUR_UPLOAD_LOGIC_APP_URL',
        get: 'YOUR_GET_LOGIC_APP_URL',
        update: 'YOUR_UPDATE_LOGIC_APP_URL',
        delete: 'YOUR_DELETE_LOGIC_APP_URL'
    }
};
"@

$frontendConfig | Out-File -FilePath "azure-config.js" -Encoding UTF8

Write-Host "âœ“ é…ç½®å·²ä¿å­˜" -ForegroundColor Green

# æ˜¾ç¤ºéƒ¨ç½²æ‘˜è¦
Write-Host "`n" -ForegroundColor White
Write-Host "========================================" -ForegroundColor Green
Write-Host "         éƒ¨ç½²å®Œæˆï¼" -ForegroundColor Green
Write-Host "========================================" -ForegroundColor Green
Write-Host ""
Write-Host "èµ„æºç»„: $ResourceGroup" -ForegroundColor White
Write-Host ""
Write-Host "å­˜å‚¨è´¦æˆ·:" -ForegroundColor Yellow
Write-Host "  åç§°: $storageAccount" -ForegroundColor White
Write-Host "  å®¹å™¨: media-files" -ForegroundColor White
Write-Host "  URL: https://$storageAccount.blob.core.windows.net/" -ForegroundColor Cyan
Write-Host ""
Write-Host "Cosmos DB:" -ForegroundColor Yellow
Write-Host "  è´¦æˆ·: $cosmosAccount" -ForegroundColor White
Write-Host "  æ•°æ®åº“: MediaDB" -ForegroundColor White
Write-Host "  å®¹å™¨: MediaItems" -ForegroundColor White
Write-Host "  ç»ˆç»“ç‚¹: $cosmosEndpoint" -ForegroundColor Cyan
Write-Host ""
Write-Host "é…ç½®æ–‡ä»¶å·²ä¿å­˜:" -ForegroundColor Yellow
Write-Host "  - config.json (å®Œæ•´é…ç½®)" -ForegroundColor White
Write-Host "  - azure-config.js (å‰ç«¯é…ç½®)" -ForegroundColor White
Write-Host ""
Write-Host "ä¸‹ä¸€æ­¥:" -ForegroundColor Yellow
Write-Host "  1. åœ¨Azureé—¨æˆ·åˆ›å»ºLogic Apps" -ForegroundColor White
Write-Host "  2. æˆ–è¿è¡Œ: .\deploy-logicapps.ps1" -ForegroundColor White
Write-Host "  3. æ›´æ–° azure-config.js ä¸­çš„Logic Apps URLs" -ForegroundColor White
Write-Host ""
Write-Host "Azureé—¨æˆ·: https://portal.azure.com" -ForegroundColor Cyan
Write-Host "èµ„æºç»„ç›´è¾¾: https://portal.azure.com/#@/resource/subscriptions/$((az account show --query id -o tsv))/resourceGroups/$ResourceGroup/overview" -ForegroundColor Cyan
Write-Host ""
Write-Host "========================================" -ForegroundColor Green
```

### è¿è¡Œä¸€é”®éƒ¨ç½²

```powershell
# æ–¹å¼1ï¼šä½¿ç”¨é»˜è®¤è®¾ç½®
.\quick-deploy.ps1

# æ–¹å¼2ï¼šè‡ªå®šä¹‰è®¾ç½®
.\quick-deploy.ps1 -ResourceGroup "my-project-rg" -Location "westus"
```

---

## ğŸ“‹ å®Œæ•´éƒ¨ç½²æµç¨‹

### 1. ä¸‹è½½æ‰€æœ‰è„šæœ¬

æˆ‘ä¼šä¸ºä½ ç”Ÿæˆæ‰€æœ‰éœ€è¦çš„æ–‡ä»¶ã€‚

### 2. æŒ‰é¡ºåºè¿è¡Œ

```powershell
# ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½²åŸºç¡€èµ„æº
.\quick-deploy.ps1

# ç¬¬äºŒæ­¥ï¼šæ‰‹åŠ¨åˆ›å»ºLogic Appsï¼ˆæš‚æ—¶è¿˜æ˜¯éœ€è¦åœ¨é—¨æˆ·åˆ›å»ºï¼‰
# æˆ–ç­‰æˆ‘ç”Ÿæˆå®Œæ•´çš„Logic Apps ARMæ¨¡æ¿

# ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²å‰ç«¯
# å°†å‰ç«¯HTMLä¸Šä¼ åˆ°Static Web App
```

---

## ğŸ¯ å…³äºLogic Appsçš„è¯´æ˜

**é‡è¦**ï¼šLogic Appsçš„ARMæ¨¡æ¿æ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå®ƒåŒ…å«å·¥ä½œæµå®šä¹‰ã€‚

**æ¨èåšæ³•**ï¼š
1. **åŸºç¡€èµ„æºç”¨è„šæœ¬éƒ¨ç½²**ï¼ˆStorageã€Cosmos DBï¼‰âœ… è‡ªåŠ¨åŒ–
2. **Logic Appsåœ¨é—¨æˆ·æ‰‹åŠ¨åˆ›å»º**ï¼ˆæˆ–ä½¿ç”¨æˆ‘æä¾›çš„ARMæ¨¡æ¿ï¼‰
3. **å‰ç«¯ç”¨è„šæœ¬éƒ¨ç½²**âœ… è‡ªåŠ¨åŒ–

**ä¸ºä»€ä¹ˆï¼Ÿ**
- Logic Appsçš„JSONå®šä¹‰å¾ˆé•¿ï¼Œæ‰‹å†™å®¹æ˜“å‡ºé”™
- åœ¨é—¨æˆ·GUIåˆ›å»ºåï¼Œå¯ä»¥å¯¼å‡ºARMæ¨¡æ¿
- GUIåˆ›å»ºæ›´ç›´è§‚ï¼Œé€‚åˆå­¦ä¹ å’Œæ¼”ç¤º

---

## ğŸ æˆ‘ä¼šç»™ä½ å‡†å¤‡ä»€ä¹ˆ

æˆ‘å¯ä»¥ä¸ºä½ åˆ›å»ºï¼š
1. âœ… `quick-deploy.ps1` - ä¸€é”®éƒ¨ç½²è„šæœ¬
2. âœ… `config.json` - è‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶
3. âš ï¸ Logic Apps ARMæ¨¡æ¿ - å¯é€‰ï¼ˆå¾ˆå¤æ‚ï¼‰
4. âœ… å‰ç«¯HTML - è‡ªåŠ¨é…ç½®å¥½è¿æ¥

---

## ğŸ¤” ä½ çš„é€‰æ‹©

### é€‰é¡¹Aï¼šæ··åˆæ–¹æ¡ˆï¼ˆæ¨èï¼‰â­â­â­â­â­
```
1. è¿è¡Œè„šæœ¬åˆ›å»ºåŸºç¡€èµ„æºï¼ˆ5åˆ†é’Ÿï¼‰
2. åœ¨é—¨æˆ·æ‰‹åŠ¨åˆ›å»ºLogic Appsï¼ˆ20åˆ†é’Ÿï¼Œå­¦ä¹ æ•ˆæœå¥½ï¼‰
3. å¤åˆ¶Logic Apps URLåˆ°é…ç½®æ–‡ä»¶
```

### é€‰é¡¹Bï¼šå®Œå…¨è‡ªåŠ¨åŒ–
```
1. è¿è¡Œå®Œæ•´éƒ¨ç½²è„šæœ¬ï¼ˆå«ARMæ¨¡æ¿ï¼‰
2. ä¸€åˆ‡è‡ªåŠ¨åˆ›å»º
3. ç›´æ¥ä½¿ç”¨

ç¼ºç‚¹ï¼š
- ARMæ¨¡æ¿å¤æ‚ï¼Œå‡ºé”™ä¸å¥½è°ƒè¯•
- ä¸ç†è§£å†…éƒ¨åŸç†
- æ¼”ç¤ºæ—¶ä¸å¦‚æ‰‹åŠ¨åˆ›å»ºæ¸…æ™°
```

---

## ğŸ’¡ æˆ‘çš„å»ºè®®

**ç¬¬ä¸€æ¬¡å­¦ä¹ ç”¨æ··åˆæ–¹æ¡ˆ**ï¼š
1. ç”¨è„šæœ¬åˆ›å»ºStorageå’ŒCosmos DBï¼ˆé¿å…é‡å¤æ“ä½œï¼‰
2. æ‰‹åŠ¨åˆ›å»ºLogic Appsï¼ˆç†è§£å·¥ä½œæµï¼Œè§†é¢‘æ¼”ç¤ºæ•ˆæœå¥½ï¼‰
3. å­¦ä¼šåå¯ä»¥å¯¼å‡ºä¸ºARMæ¨¡æ¿ä¾›æœªæ¥ä½¿ç”¨

**ç†ç”±**ï¼š
- Logic Appsæ˜¯ä½œä¸šé‡ç‚¹ï¼Œéœ€è¦ç†è§£
- æ‰‹åŠ¨åˆ›å»ºä¸€æ¬¡åï¼Œå¯ä»¥å¯¼å‡ºæ¨¡æ¿
- è§†é¢‘æ¼”ç¤ºæ—¶èƒ½æ¸…æ¥šè§£é‡Šæ¯ä¸ªæ­¥éª¤

---

ä½ æƒ³è¦å“ªç§æ–¹æ¡ˆï¼Ÿæˆ‘å¯ä»¥ä¸ºä½ ç”Ÿæˆå¯¹åº”çš„è„šæœ¬æ–‡ä»¶ï¼

1. **å¿«é€Ÿå¼€å§‹** - ç»™æˆ‘ç”Ÿæˆ `quick-deploy.ps1`ï¼Œæˆ‘å…ˆåˆ›å»ºåŸºç¡€èµ„æº
2. **å®Œå…¨è‡ªåŠ¨** - ç»™æˆ‘ç”ŸæˆåŒ…å«Logic Appsçš„å®Œæ•´ARMæ¨¡æ¿
3. **æˆ‘æƒ³æ‰‹åŠ¨å­¦** - ç»§ç»­ç”¨GUIåˆ›å»ºï¼Œä½†ç»™æˆ‘ä¸€ä¸ªæ£€æŸ¥æ¸…å•

å‘Šè¯‰æˆ‘ä½ çš„é€‰æ‹©ï¼ğŸš€

