<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Match Detail - Sports Moments</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <div class="breadcrumb">
            <a href="index.html">‚Üê Back to Match List</a>
        </div>

        <!-- Match Detail Header -->
        <div class="match-detail-header">
            <div class="match-title-section">
                <h1 id="matchTitle">Loading...</h1>
                <div class="match-meta-info">
                    <span id="matchDate">üìÖ 2025-11-15</span>
                    <span class="divider">‚Ä¢</span>
                    <span id="matchLocation">üìç Gym</span>
                    <span class="divider">‚Ä¢</span>
                    <span id="matchResult" class="badge badge-win">Win 78:72</span>
                </div>
                <div class="match-tags" id="matchTags"></div>
            </div>
            <div class="match-actions">
                <button class="btn btn-secondary" onclick="editMatch()">‚úèÔ∏è Edit</button>
                <button class="btn btn-danger" onclick="deleteMatch()">üóëÔ∏è Delete</button>
            </div>
        </div>

        <!-- Video Player -->
        <div class="video-section">
            <div class="video-player-wrapper">
                <video id="matchVideo" controls controlsList="nodownload" preload="metadata">
                    <source id="videoSource" src="" type="video/mp4">
                    Your browser does not support video playback
                </video>
            </div>
        </div>

        <!-- Tactical Annotations -->
        <div class="annotations-section">
            <div class="section-header">
                <h2>üìã Tactical Annotations</h2>
                <button class="btn btn-primary" onclick="showAnnotationModal()">+ Add Annotation</button>
            </div>
            <div id="annotationList" class="annotation-list">
                <!-- Dynamically loaded -->
            </div>
        </div>

        <!-- Discussion -->
        <div class="comments-section">
            <h2>üí¨ Discussion</h2>
            <div class="comment-input-wrapper">
                <textarea id="commentInput" placeholder="Share your thoughts..."></textarea>
                <button class="btn btn-primary" onclick="addComment()">Post Comment</button>
            </div>
            <div id="commentList" class="comment-list">
                <!-- Dynamically loaded -->
            </div>
        </div>
    </div>

    <!-- Edit Match Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚úèÔ∏è Edit Match Information</h2>
                <span class="close" onclick="closeEditModal()">&times;</span>
            </div>
            <form id="editForm" onsubmit="handleEditSubmit(event)">
                <div class="form-group">
                    <label>Match Title *</label>
                    <input type="text" id="editMatchTitle" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Match Date *</label>
                        <input type="date" id="editMatchDate" required>
                    </div>
                    <div class="form-group">
                        <label>Match Time *</label>
                        <input type="time" id="editMatchTime" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Opponent Team *</label>
                    <input type="text" id="editOpponent" required>
                </div>
                
                <div class="form-group">
                    <label>Location</label>
                    <input type="text" id="editLocation">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Our Score *</label>
                        <input type="number" id="editOurScore" required min="0">
                    </div>
                    <div class="form-group">
                        <label>Opponent Score *</label>
                        <input type="number" id="editOpponentScore" required min="0">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Match Result</label>
                    <div class="radio-group">
                        <label><input type="radio" name="editOutcome" value="win" checked> Win üèÜ</label>
                        <label><input type="radio" name="editOutcome" value="draw"> Draw ü§ù</label>
                        <label><input type="radio" name="editOutcome" value="loss"> Loss üòî</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Tags</label>
                    <input type="text" id="editTags" placeholder="Comma separated, e.g., Home, Win, Playoffs">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeEditModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="editBtn">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Tactical Annotation Modal -->
    <div id="annotationModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>üìã Create Tactical Annotation</h2>
                <span class="close" onclick="closeAnnotationModal()">&times;</span>
            </div>
            <div class="annotation-editor">
                <div class="editor-left">
                    <div class="form-group">
                        <label>Annotation Title *</label>
                        <input type="text" id="annotationTitle" placeholder="e.g., Fast Break - Q3">
                    </div>
                    <div class="form-group">
                        <label>Timestamp</label>
                        <input type="text" id="annotationTimestamp" readonly placeholder="Auto set to current playback time">
                    </div>
                    <div class="form-group">
                        <label>Tactical Description</label>
                        <textarea id="annotationDescription" rows="4" placeholder="Describe the tactical execution..."></textarea>
                    </div>
                    <div class="form-group">
                        <label>Tags</label>
                        <input type="text" id="annotationTags" placeholder="e.g., Fast Break, Success, Transition">
                    </div>
                </div>
                <div class="editor-right">
                    <div class="canvas-wrapper">
                        <label>Tactical Drawing</label>
                        <canvas id="tacticalCanvas" width="600" height="400"></canvas>
                        <div class="canvas-tools">
                            <button class="tool-btn" onclick="selectTool('arrow')" title="Arrow">‚û°Ô∏è</button>
                            <button class="tool-btn" onclick="selectTool('circle')" title="Circle">‚≠ï</button>
                            <button class="tool-btn" onclick="selectTool('line')" title="Line">‚îÅ</button>
                            <button class="tool-btn" onclick="selectTool('text')" title="Text">A</button>
                            <input type="color" id="colorPicker" value="#ff0000" title="Color">
                            <button class="tool-btn" onclick="clearCanvas()" title="Clear">üóëÔ∏è</button>
                            <button class="tool-btn" onclick="undoCanvas()" title="Undo">‚Ü∂</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeAnnotationModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveAnnotation()">Save Annotation</button>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="appinsights.js"></script>
    <script src="auth.js"></script>
    <script src="match-detail.js"></script>
    <script>
        // È°µÈù¢Âä†ËΩΩÊó∂Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
        if (!requireLogin()) {
            // Êú™ÁôªÂΩï‰ºöËá™Âä®Ë∑≥ËΩ¨Âà∞ÁôªÂΩïÈ°µ
        }
        
        // Ë∑üË∏™È°µÈù¢ËÆøÈóÆ
        if (window.AppInsightsTracking) {
            window.AppInsightsTracking.trackPagePerformance('MatchDetail');
        }
    </script>
</body>
</html>

